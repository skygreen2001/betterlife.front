<!DOCTYPE html>
<html lang="zh-CN">
<head>
    @@include('../../layout/header.html', {
        "title"     : "Betterlife Front UI",
        "rel-prefix": "../.."
    })
</head>
<body>
    <!--nav begin-->
    @@include('../../layout/menu.html')
    <!--nav end-->

    <!--content begin-->
    <div class="container-fluid list">
        <div class="row up-container">
            <!-- 上半部分 -->
            <div class="filter-up">
                <div class="filter-up-right col-sm-12">
                    <div>
                        <i aria-label="search-menu" class="glyphicon glyphicon-search" aria-hidden="true"></i>
                        <input id="input-search" type="search" placeholder="搜索名称" aria-controls="infoTable" />
                        <button id="btn-query" type="button" class="btn btn-query">搜索</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="table-responsive col-xs-12">
            <table id="infoTable" class="display nowrap dataTable table table-striped table-bordered">
                <thead>
                    <tr>
                        <th>序号</th>
                        <th>名称</th>
                        <th>联系人</th>
                        <th>手机号</th>
                        <th>封面</th>
                        <th>状态</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
        </div>
    </div>
    <!--content end-->

    <!--footer begin-->
    @@include('../../layout/footer.html',{
      "rel-prefix": "../.."
    })
    <!--footer end-->
    <script src="../../js/normal/list.js"></script>
    <script type="text/javascript">
    $(function(){

        //Datatables中文网[帮助]: http://datatables.club/
        var infoTable = $('#infoTable').DataTable({
            "language":{
                url: '../../data/config/Chinese.json'
            },
            "processing": true,
            "serverSide": true,
            "ajax": {
                "url" : "../../data/list.json",
                // "type": "GET",
                // "contentType": "application/json",
                "data": function ( d ) {
                    d.query = $("#input-search").val();
                    return d;
                    // return JSON.stringify( d );
                },
                //可以对返回的结果进行改写
                "dataFilter": function(data){
                    // return data;

                    var json = jQuery.parseJSON( data );
                    var p = infoTable.ajax.params();
                    json.draw = p.draw;
                    var info = infoTable.page.info();
                    var length= info.length;
                    var page = p.start / length + 1;
                    if (page == 1) {
                      json.data = json.data.slice(0, p.length);
                    } else {
                      json.data = json.data.slice(p.length);
                    }
                    return JSON.stringify( json ); // return JSON string

                }
            },
            "responsive"   : true,
            "searching"    : false,
            "ordering"     : false,
            "dom"          : '<"top">rt<"bottom"lp><"clear">',
            "bLengthChange": true,
            "aLengthMenu"  : [[10, 25, 50, 100,-1],[10, 25, 50, 100,'全部']],
            "columns": [
                { data:"id" },
                { data:"name" },
                { data:"contactName" },
                { data:"phone" },
                { data:"imgUrl" },
                { data:"status"},
                { data:"id" }
            ],
            "columnDefs": [
                {"orderable":false,"targets":6,
                    "render" : function(data, type, row) {
                        var result = '<a href="#?accountId='+data+'" class="pass">通过</a>&nbsp;<a href="#?accountId='+data+'" class="refuse">拒绝</a>';
                        return result;
                     }
                },
                {"orderable":false,"targets":5,
                    "render" : function(data,type,row){
                        if (data==0){
                            return '<span class="status-fail">审核失败</span>';
                        }else if ( data == 1 )
                            return '<span class="status-pass">审核通过</span>';
                        else{
                            return '<span class="status-wait">待审核</span>';
                        }
                    }
                },
                {"orderable":false,"targets":4,
                     "render" : function(data,type,row){
                         if (data){
                             return '<a title="'+row.name+'" href="'+data+'" target="_blank" class="view" data-rel="'+data+'">查看</a>';
                         }else{
                             return "";
                         }
                     }
                }
            ],
            // "aoColumns"    : [
            //     null,
            //     { "sType": "chinese-string" },//中文排序列
            //     { "sType": "chinese-string" },
            //     null,
            //     null,
            //     null,
            //     null
            // ],
            "initComplete":function(){ },
            "drawCallback": function( settings ) {
              $.dataTable.pageNumDisplay(this);
            }
        });

        $("#btn-query").click(function(){infoTable.draw();});


    });

    </script>

</body>
</html>
