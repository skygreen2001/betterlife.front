<!DOCTYPE html>
<html lang="zh-CN">
<head>
    
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
    <title>Betterlife Front UI</title>

    <link rel="stylesheet" href="../../css/common.min.css">
    <script type="text/javascript" src="../../js/common/base.min.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>
<body>
    <!-- main nav begin -->
    
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/">Betterlife Front UI</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            <li><a href="/">首页</a></li>
            <li><a href="../../html/blog/list.html">读书</a></li>
            <li><a href="#contact">电影</a></li>
            <li><a href="#about">音乐</a></li>
            <li><a href="#contact">研发</a></li>
            <li><a href="#contact">购物</a></li>
            <li><a href="#contact">话题</a></li>
            <li><a href="#contact">幽默</a></li>
            <li class="search-toggle"><a href="../../html/model/preview.html"><span><span class="menu-search-text">搜索</span><span class="glyphicon glyphicon-search" aria-hidden="true"></span></span></a></li>
          </ul>
        </div><!--/.nav-collapse -->
        <div id="searchform-header" class="hidden">
          <div id="searchform-header-inner">
            <form method="get" action="" class="header-searchform">
              <input type="search" class="form-control" name="s" autocomplete="off" autofocus="autofocus" placeholder="搜索">
            </form>
            <span id="searchform-header-close" class="glyphicon glyphicon-remove search-toggle"></span>
          </div>
        </div>
      </div>
    </nav>

    <!-- main nav end -->

    <!-- page container begin -->
    <div id="wrapper" class="page-container">

        <!-- page content begin -->
        <div class="page-content">
            <!-- main sidebar begin -->
            
<!-- Sidebar -->
<div id="sidebar-wrapper">
    <ul class="sidebar-nav">
        <li class="sidebar-brand">
            <a href="#">
                Start Bootstrap
            </a>
        </li>
        <li>
            <a href="#">Dashboard</a>
        </li>
        <li>
            <a href="#">Shortcuts</a>
        </li>
        <li>
            <a href="#">Overview</a>
        </li>
        <li>
            <a href="#">Events</a>
        </li>
        <li>
            <a href="#">About</a>
        </li>
        <li>
            <a href="#">Services</a>
        </li>
        <li>
            <a href="#">Contact</a>
        </li>
    </ul>
</div>
<!-- /#sidebar-wrapper -->

            <!-- main sidebar end -->

            <!-- main content begin -->
            <div id="page-content-wrapper">

                <!-- page header begin -->
                <div class="page-header" style="display:none;">

                  <div class="breadcrumb-line">
                    <ul class="breadcrumb">
                      <li><a href="index.html"><i class="icon-home2 position-left"></i> Home</a></li>
                      <li class="active">Dashboard</li>
                    </ul>
                  </div>
                </div>
                <!-- page header end -->

                <!-- content area begin -->
                <div class="container-fluid list">
                    <div class="row">
                    <!-- list header begin -->
                    <div class="row up-container">
                        <!-- 上半部分 -->
                        <div class="filter-up">
                            <div class="filter-up-right col-sm-12">
                                <div>
                                    <i aria-label="search-menu" class="glyphicon glyphicon-search" aria-hidden="true"></i>
                                    <input id="input-search" type="search" placeholder="搜索名称" aria-controls="infoTable" />
                                    <button id="btn-query" type="button" class="btn btn-query">搜索</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- list header end -->

                    <!-- list content begin -->

                    <div class="table-responsive col-xs-12">
                        <table id="infoTable" class="display nowrap dataTable table table-striped table-bordered">
                            <thead>
                                <tr>
                                    <th>序号</th>
                                    <th>名称</th>
                                    <th>编码</th>
                                    <th>联系人</th>
                                    <th>手机号</th>
                                    <th>封面</th>
                                    <th>状态</th>
                                    <th>操作</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <!-- list content end -->
                    </div>

                </div>
                <!-- content area end -->

                <!--footer begin-->
                
    <footer>
        <div id="footer-inner" class="container clr">
            <div id="copyright" class="clr" role="contentinfo">© 2017-2020 Betterlife - All Rights Reserved.&nbsp;<a title="License" href="https://github.com/skygreen2001/betterlife.front/blob/master/LICENSE" target="_blank">License</a>&nbsp;| <a title="Help" href="https://github.com/skygreen2001/betterlife.front" target="_blank">Help</a></div><!-- #copyright -->
        </div>
    </footer>

    <script type="text/javascript" src="../../js/common/bower/bower.min.js"></script>
    <script type="text/javascript" src="../../js/common/common.jquery.min.js"></script>

                <!--footer end-->
            </div>
            <!-- main content end -->
        </div>
        <!-- page container end -->
    </div>

    <!-- template begin -->
    <div id="image-model"></div>
    <script id="imgModalTmpl" type="text/x-jsrender">
    <!-- Creates the bootstrap modal where the image will appear -->
    <div class="modal fade" id="imageModal" tabindex="-1" role="dialog" aria-labelledby="imageModalLabel" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">X</span></button>
          </div>
          <div class="modal-body">
            <a id="imagePreview-link" href="#" target="_blank"><img src="" id="imagePreview" style="width: 100%; height: 100%;" ></a>
          </div>
        </div>
      </div>
    </div>
    </script>
    <script id="imgTmpl" type="text/x-jsrender">
    <a id="{{:img_id}}" href="#"><img src="{{:img_src}}" alt="{{:img_name}}" /></a>
    </script>
    <script id="actionTmpl" type="text/x-jsrender">
    <a id="info-view{{:id}}" href="#" class="view" data-toggle="modal" data-target="#infoModal">查看</a>&nbsp;
    <a id="info-edit{{:id}}" href="#" class="edit" data-toggle="modal" data-target="#infoModal">修改</a>&nbsp;
    <a id="info-dele{{:id}}" href="#" class="dele" data-toggle="modal" data-target="#infoModal">删除</a>
    </script>
    <!-- template end -->

    <script src="../../js/normal/list.js"></script>
    <!-- Menu Toggle Script -->
    <script type="text/javascript">
        $(function(){
            // $("#wrapper").toggleClass("toggled");
            $("#menu-toggle").click(function(e) {
                e.preventDefault();
                $("#wrapper").toggleClass("toggled");
            });
        });
    </script>

    <script type="text/javascript">
    $(function(){
        $("#image-model").html($.templates("#imgModalTmpl"));

        //Datatables中文网[帮助]: http://datatables.club/
        var infoTable = $('#infoTable').DataTable({
            "language":{
                url: '../../data/config/Chinese.json'
            },
            "processing": true,
            "serverSide": true,
            "ajax": {
                "url" : "../../data/list.json",
                // "type": "GET",
                // "contentType": "application/json",
                "data": function ( d ) {
                    d.query = $("#input-search").val();
                    return d;
                    // return JSON.stringify( d );
                },
                //可以对返回的结果进行改写
                "dataFilter": function(data){
                    // return data;
                    var json = jQuery.parseJSON( data );
                    var p = infoTable.ajax.params();
                    json.draw = p.draw;
                    var info = infoTable.page.info();
                    var length= info.length;
                    var page = p.start / length + 1;
                    if (page == 1) {
                      json.data = json.data.slice(0, p.length);
                    } else {
                      json.data = json.data.slice(p.length);
                    }
                    return JSON.stringify( json ); // return JSON string
                }
            },
            "responsive"   : true,
            "searching"    : false,
            "ordering"     : false,
            "dom"          : '<"top">rt<"bottom"lp><"clear">',
            "bLengthChange": true,
            "aLengthMenu"  : [[10, 25, 50, 100,-1],[10, 25, 50, 100,'全部']],
            "columns": [
                { data:"id" },
                { data:"name" },
                { data:"code" },
                { data:"contactName" },
                { data:"phone" },
                { data:"imgUrl" },
                { data:"status"},
                { data:"id" }
            ],
            "columnDefs": [
                {"orderable":false,"targets":5,
                    "render" : function(data, type, row) {
                        // var result = '<a id="imgUrl'+row.id+'" href="#"><img src="'+data+'" alt="'+row.imgName+'" /></a>';
                        var data     = {
                            "img_id"  : "imgUrl"+row.id,
                            "img_src" : data,
                            "img_name": row.imgName
                        };
                        var result = $.templates("#imgTmpl").render(data);

                        $("body").off('click', 'a#imgUrl'+row.id);
                        $("body").on('click', 'a#imgUrl'+row.id, function(){
                            $('#imagePreview').attr('src', $('a#imgUrl' + row.id + " img").attr('src'));
                            $('#imagePreview-link').attr('href', $('a#imgUrl' + row.id + " img").attr('src'));
                            $('#imageModal').modal('show');
                        });
                        return result;
                    }
                },
                {"orderable":false, "targets":6,
                    "render" : function(data,type,row){
                        if (data==0){
                            return '<span class="status-fail">审核失败</span>';
                        }else if ( data == 1 )
                            return '<span class="status-pass">审核通过</span>';
                        else{
                            return '<span class="status-wait">待审核</span>';
                        }
                    }
                },
                {"orderable":false, "targets":7,
                    "render" : function(data, type, row){
                        // var result = '<a href="#" id ="info-view'+data+'" class="view" data-toggle="modal" data-target="#infoModal">查看</a>&nbsp;<a href="#" id ="info-edit'+data+'" class="edit" data-toggle="modal" data-target="#infoModal">修改</a>&nbsp;<a id="info-del'+data+'" data-toggle="modal" data-target="#infoModal" href="#" class="del">删除</a>';
                        var result = $.templates("#actionTmpl").render({ "id"  : data });

                        $("body").off('click', 'a#info-view'+data);
                        $("body").on('click', 'a#info-view'+data, function(){//查看
                            bootbox.confirm("确定要查看该用户:" + data + "?",function(result){
                                if ( result == true ){
                                    console.log("查看用户:" + data);
                                }
                            });
                        });
                        $("body").off('click', 'a#info-edit'+data);
                        $("body").on('click', 'a#info-edit'+data, function(){//修改
                            bootbox.confirm("确定要编辑该用户:" + data + "?",function(result){
                                if ( result == true ){
                                    console.log("编辑用户:" + data);
                                }
                            });
                        });
                        $("body").off('click', 'a#info-dele'+data);
                        $("body").on('click', 'a#info-dele'+data, function(){//删除
                            bootbox.confirm("确定要删除该用户:" + data + "?",function(result){
                                if ( result == true ){
                                    console.log("删除用户:" + data);
                                }
                            });
                        });
                        return result;
                    }
                }
            ],
            // "aoColumns"    : [
            //     null,
            //     { "sType": "chinese-string" },//中文排序列
            //     { "sType": "chinese-string" },
            //     null,
            //     null,
            //     null,
            //     null
            // ],
            "initComplete":function(){ },
            "drawCallback": function( settings ) {
                $.dataTable.pageNumDisplay(this);
            }
        });
        $("#btn-query").click(function(){infoTable.draw();});
    });
    </script>

</body>
</html>
